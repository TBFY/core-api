PREFIX org: <http://www.w3.org/ns/org#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX tbfy: <http://data.tbfy.eu/ontology/ocds/>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX schema: <http://schema.org/>
SELECT (?id as ?oid) ?dat ?qtitle ?isf ?stat
WHERE {
	?id a tbfy:Organisation .
  ?id tbfy:isSupplierFor ?isf .
  ?isf a tbfy:Award .
  OPTIONAL { ?isf tbfy:awardDate ?dat } .
  OPTIONAL { ?isf dcterms:title ?qtitle } .
  OPTIONAL { ?isf dcterms:description ?des } .
  OPTIONAL { ?isf tbfy:awardStatus ?stat } .
	FILTER ( isNumeric(?status) = True || regex(?qstatus, ?status, "i") ) .
	FILTER ( isNumeric(?title) = True || regex(?qtitle, ?title, "i") ) .
	FILTER ( isNumeric(?description) = True || regex(?qdescription, ?description, "i") ) .
	FILTER ( isNumeric(?start_dt) = True || ?qdate > ?start_dt ) .
	FILTER ( isNumeric(?end_dt) = True || ?qdate < ?end_dt ) .
}
